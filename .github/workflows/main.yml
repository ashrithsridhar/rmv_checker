# .github/workflows/check_appointment.yml
name: RMV Appointment Checker

# Trigger on schedule (every 5 minutes) and manually via workflow_dispatch
on:
  schedule:
    - cron: '*/5 * * * *'
  workflow_dispatch:

jobs:
  check-appointment:
    runs-on: ubuntu-latest
    env:
      # Pushover credentials – store these in
      # Settings → Secrets and variables → Actions
      PUSHOVER_USER_KEY:   ${{ secrets.PUSHOVER_USER_KEY }}
      PUSHOVER_API_TOKEN:  ${{ secrets.PUSHOVER_API_TOKEN }}

      # Optional override of loop/sleep settings
      LOOP_COUNT:          5
      SLEEP_SECONDS:       60

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up Python 3.x
        uses: actions/setup-python@v5
        with:
          python-version: '3.x'

      - name: Install dependencies and browsers
        run: |
          python -m pip install --upgrade pip
          pip install playwright requests beautifulsoup4
          python -m playwright install

      - name: Run RMV appointment checker
        run: python check_appointment.py
